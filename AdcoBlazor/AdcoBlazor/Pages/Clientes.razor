@page "/clientes"

@using System.Collections.Generic
@using System.Linq
@using System.Net.Http
@using System.Net.Http.Json
@using Newtonsoft.Json;
@using System.Net.Http.Headers;
@using RestSharp;
@using RestSharp.Authenticators;
@using System.Text;
@using AdcoBlazor.Models;
@using AdcoBlazor.Data;


@using System.Net;
@using System.Text.Json;
@inject HttpClient HttpClient
@inject AuthenticationService AuthenticationService
@inject AppState AppState


<body class="sidebar-mini-xs">



	<div class="page">
		<div class="sidebar">
			<Sidebar />
		</div>



		<main class="" style="margin-left:75px;">
			<div class="">

				<NavBar />

			</div>

			<article class="content" style="    margin-left: 15px;">

				<section class="content-header">
					<div class="container-fluid">
						<div class="row mb-2">
							<div class="col-sm-6">
								<h1>Clientes</h1>
								<h2></h2>
							</div>
							<div class="col-sm-6">
								<ol class="breadcrumb float-sm-right">

									<li class="breadcrumb-item"><a class="btn btn-block btn-success" href="clientesañadir">Añadir</a></li>
								</ol>
							</div>
						</div>
					</div>
				</section>

				<div class="col-12">
					<div class="card">
						<div class="card-body">

							<table class="table">
								<thead>
									<tr>
										<th>.</th>
										<th>Nombre</th>
										<th>Metodo pago</th>
										<th>Fecha</th>
										<th>Documentos</th>
										<th>Observaciones</th>
										<th>Agregado por</th>
									</tr>
								</thead>
								<tbody>
									@foreach (var clientes in Clients)
									{
										<tr>
											<td>@clientes.Id</td>
											<td>@clientes.Nombre</td>
											<td>@clientes.MetodoPago</td>
											<td>@clientes.Documentos</td>
											<td>@clientes.Observaciones</td>
											<td>@clientes.CreatedBy</td>
										</tr>
									}
								</tbody>
							</table>

						</div>

					</div>

				</div>

			</article>

		</main>
	</div>

</body>

@code {
	private List<Client> Clients { get; set; } = new List<Client>();

	protected override async Task OnInitializedAsync()
	{
		// Utiliza el token almacenado en AppState
		string token = AppState.AccessToken;
		Clients = await AuthenticationService.GetClientDataAsync(token);

		// Muestra el nombre de usuario almacenado en AppState
		string username = AppState.Username;
	}
}
